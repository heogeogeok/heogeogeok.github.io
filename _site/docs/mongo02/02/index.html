<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(2)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(2) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(2) > ul.nav-list { display: block; }</style><script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico" type="image/x-icon"><title>2.2. Indexes | The Internals of MongoDB</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="2.2. Indexes" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="http://localhost:4000/docs/mongo02/02/" /><meta property="og:url" content="http://localhost:4000/docs/mongo02/02/" /><meta property="og:site_name" content="The Internals of MongoDB" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="2.2. Indexes" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A Jekyll theme for documentation","headline":"2.2. Indexes","url":"http://localhost:4000/docs/mongo02/02/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> The Internals of MongoDB </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 1. Databases and Collections category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/mongo01" class="nav-list-link">1. Databases and Collections</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/mongo01/01/" class="nav-list-link">1.1. Database Internals</a><li class="nav-list-item"><a href="/docs/mongo01/02/" class="nav-list-link">1.2. Architecture</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 2. Memory Management category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/mongo02" class="nav-list-link">2. Memory Management</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/mongo02/01/" class="nav-list-link">2.1. Data Storage</a><li class="nav-list-item"><a href="/docs/mongo02/02/" class="nav-list-link">2.2. Indexes</a><li class="nav-list-item"><a href="/docs/mongo02/03/" class="nav-list-link">2.3. Concurrency Control</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in 3. Block Manager category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/mongo03" class="nav-list-link">3. Block Manager</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/mongo03/01/" class="nav-list-link">3.1. Page Operations</a><li class="nav-list-item"><a href="/docs/mongo03/02/" class="nav-list-link">3.2. Checksum</a><li class="nav-list-item"><a href="/docs/mongo03/03/" class="nav-list-link">3.3. Space Management</a><li class="nav-list-item"><a href="/docs/mongo03/04/" class="nav-list-link">3.4. Compression</a><li class="nav-list-item"><a href="/docs/mongo03/05/" class="nav-list-link">3.5. Logging</a></ul><li class="nav-list-item"><a href="/docs/" class="nav-list-link">References</a></ul><ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/heogeogeok" class="nav-list-link external" > GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search The Internals of MongoDB" aria-label="Search The Internals of MongoDB" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/mongo02">2. Memory Management</a><li class="breadcrumb-nav-list-item"><span>2.2. Indexes</span></ol></nav><div id="main-content" class="main-content"><main><div style="text-align: center;" class="fs-10"> 2.2. INDEXES</div><p>MongoDB offers extensive support for indexing documents, a crucial feature when dealing with large collections containing tens of thousands of documents. Without an index, MongoDB would need to scan each document individually to find the data you need—similar to a librarian searching every book in a library to find the one you’re looking for. In contrast, an indexing system allows MongoDB to quickly locate the relevant documents, much like how a librarian uses the Dewey Decimal system to locate books.</p><h3 id="built-in-indexing-on-_id-key"> <a href="#built-in-indexing-on-_id-key" class="anchor-heading" aria-labelledby="built-in-indexing-on-_id-key"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Built-in Indexing on <code class="language-plaintext highlighter-rouge">_id</code> Key</h3><ul><li><strong>Automatic Indexing</strong>: All documents in MongoDB are automatically indexed on the <code class="language-plaintext highlighter-rouge">_id</code> key. This key is special because it cannot be deleted, and the index ensures that each value is unique. This guarantees that every document is uniquely identifiable, something that traditional RDBMS systems don’t always ensure.</ul><h3 id="creating-custom-indexes"> <a href="#creating-custom-indexes" class="anchor-heading" aria-labelledby="creating-custom-indexes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating Custom Indexes</h3><ul><li><strong>Uniqueness Enforcement</strong>:When creating your own indexes, you can decide whether to enforce uniqueness. By default, MongoDB will return an error if you try to create a unique index on a key that has duplicate values. However, there are many scenarios where allowing duplicates in an index is beneficial. For instance, if your application frequently searches by last name, it makes sense to create an index on the <code class="language-plaintext highlighter-rouge">lastname</code> key, even though duplicates are likely.<li><strong>Indexing Embedded Documents</strong>:MongoDB also supports indexing embedded documents. For example, if you store addresses in an <code class="language-plaintext highlighter-rouge">address</code> field, you can create an index on the ZIP or postal code. This enables you to quickly retrieve documents based on postal codes.<li><strong>Composite Indexes</strong>: MongoDB allows you to create composite indexes, which use two or more keys to build a single index. For example, you could create an index that combines both <code class="language-plaintext highlighter-rouge">lastname</code> and <code class="language-plaintext highlighter-rouge">firstname</code> fields. This would make searching for a full name very efficient, as MongoDB can rapidly narrow down the results.</ul><h3 id="data-modeling-and-indexing-in-mongodb"> <a href="#data-modeling-and-indexing-in-mongodb" class="anchor-heading" aria-labelledby="data-modeling-and-indexing-in-mongodb"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data Modeling and Indexing in MongoDB</h3><ul><li><strong>Conceptual Mapping with RDBMS</strong>:In MongoDB, there is a conceptual mapping between traditional RDBMS data models and MongoDB’s approach. A MongoDB collection corresponds to a table in RDBMS, a BSON document is similar to a row, and key-value pairs in a document are analogous to fields in a row.<li><strong>Primary Index on <code class="language-plaintext highlighter-rouge">_id</code></strong>:When a new document is created, MongoDB automatically assigns an <code class="language-plaintext highlighter-rouge">_id</code> as the primary key, with its value increasing monotonically. A primary index is also automatically built based on the <code class="language-plaintext highlighter-rouge">_id</code> key.<li><strong>Secondary Indexes</strong>:MongoDB supports secondary indexes, and each time a new secondary index is created, a corresponding index file is generated in the associated directory. However, when deciding to add a secondary index, you must carefully consider the trade-off between read and write performance. For workloads with frequent updates, more secondary indexes can slow down the system, as each update to collection pages requires corresponding updates to the secondary indexes.<li><strong>Storage Structure</strong>: MongoDB’s WiredTiger storage engine uses the B+Tree data structure to store both collection and index files. Unlike RDBMS, MongoDB offers flexible schemas within its semi-structured BSON format, and JOIN operations are <em>not necessary</em> in MongoDB.</ul></main><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2017-2020 Patrick Marsceill. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/just-the-docs/just-the-docs/tree/main/docs/mongo02/02.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
